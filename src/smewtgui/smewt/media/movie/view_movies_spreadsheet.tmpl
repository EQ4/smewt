#set allmovies = $movies

<%
from smewt import SmewtUrl

movies = sorted([ { 'title': m['title'],
                    'year': m['year'],
                    'rating': m['rating'] or '-',
                    'genres': ', '.join(m['genres'] or []) or '-',
                    'url': SmewtUrl('media', 'movie/single', { 'title': m['title'] }),
                    'poster': m['loresImage'] } for m in allmovies ], key = lambda x: x['title'])

import os, os.path
# FIXME: this is not the correct way to do it...
import_dir = os.path.join(os.getcwd(), 'smewt', 'media', 'common')

%>

<html>
<head>
  <title>All movies view</title>
  <link rel="stylesheet" href="file://$(import_dir)/../movie/movies.css">

		<style type="text/css" title="currentStyle">
			@import "file://$(import_dir)/dataTables-1.4/media/css/demos.css";
		</style>

    <script type="text/javascript" language="javascript" src="file://$(import_dir)/dataTables-1.4/media/js/jquery.js"></script>
    <script type="text/javascript" language="javascript" src="file://$(import_dir)/dataTables-1.4/media/js/jquery.dataTables.js"></script>
    <script type="text/javascript" charset="utf-8">
    #raw
        $(document).ready(function() {
            $('#example').dataTable({
                });
            $('#example').css('width', '100%');
            $('#example').before('<p>&nbsp;</p>');
        } );
    #end raw
		</script>

</head>



<body>

<div id="wrapper">
	<div id="header">
		ALL MOVIES
	</div>
	<div id="container">

    <table id="example" class="display">
      <thead>
        <tr><th>Title</th><th>Year</th><th>Rating</th><th>Genres</th></tr>
      </thead>
      <tbody>
      #for m in movies:
        <tr><td><a href="$m.url">$m.title</a></td><td class="center">$m.year</td><td class="center">$m.rating</td><td>$m.genres</td></tr>
      #end for
      </tbody>
      <tfoot>
        <tr><th>Title</th><th>Year</th><th>Rating</th><th>Genres</th></tr>
      </tfoot>
    </table>

  </div>
</div>

</body>
</html>
