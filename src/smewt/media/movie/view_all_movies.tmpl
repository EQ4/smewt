#set allmovies = $movies
#set allmedias = $medias
<%
from smewt import SmewtUrl, Media

allmovies = [movie for movie in allmovies if len(allmedias.findAll(Media, method = lambda x: x.metadata == movie)) != 0]

movies = sorted([ { 'title': m['title'],
                    'url': SmewtUrl('media', 'movie/single', { 'title': m['title'] }),
                    'poster': m['loresImage'] } for m in allmovies ], key = lambda x: x['title'])

from smewt.base.utils import smewtDirectory
import_dir = smewtDirectory('smewt', 'media', 'movie')
%>

<html>
<head>
  <title>All movies view</title>
  <link rel="stylesheet" href="file://$(import_dir)/movies.css">
</head>

<body>

<div id="wrapper">
	<div id="header">
		ALL MOVIES
	</div>
	<div id="container">

		<div id="left-side">
      #for m in movies[::2]
        <div class="movie">
          <img src="file://$m.poster" />
          <a href='$m.url'>$m.title</a>
        </div>
      #end for
    </div>

    <div id="right-side">
      #for m in movies[1::2]
        <div class="movie">
          <img src="file://$m.poster" />
          <a href='$m.url'>$m.title</a>
        </div>
      #end for
    </div>

  </div>
</div>

</body>
</html>
